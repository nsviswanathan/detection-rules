title: Windows Credential Manager Access
id: 2c7f1c2d-14b7-4b46-a0b1-3d5d5a8121d9
status: experimental
description: Detects access to Windows Credential Manager via vaultcmd and cmdkey usage patterns.
author: N SV
date: 2025-12-20
references:
  - https://attack.mitre.org/techniques/T1555/004/
tags:
  - attack.credential_access
  - attack.t1555.004
logsource:
  category: process_creation
  product: windows
detection:
  selection_vaultcmd:
    Image|endswith: '\vaultcmd.exe'
    CommandLine|contains:
      - '/list'
      - '/creds'
      - '/all'
  selection_cmdkey:
    Image|endswith: '\cmdkey.exe'
    CommandLine|contains:
      - '/list'
      - '/add'
      - '/delete'
  condition: selection_vaultcmd or selection_cmdkey
fields:
  - Image
  - CommandLine
  - User
falsepositives:
  - Legitimate admin usage (rare in normal user endpoints)
  - Enterprise scripts for credential rotation (should be signed/approved)
level: medium
