title: PowerShell Encoded Command Execution
id: 5bf62c2d-3b7a-4c8a-b58d-86c2200fb0a3
status: stable
description: Detects PowerShell usage with encoded commands which is common in malware and living-off-the-land attacks.
author: N SV
date: 2025-12-20
references:
  - https://attack.mitre.org/techniques/T1059/001/
  - https://attack.mitre.org/techniques/T1027/
tags:
  - attack.execution
  - attack.t1059.001
  - attack.defense_evasion
  - attack.t1027
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    Image|endswith:
      - '\powershell.exe'
      - '\pwsh.exe'
    CommandLine|contains:
      - '-enc'
      - '-encodedcommand'
      - 'FromBase64String'
  filter_legit:
    ParentImage|contains:
      - '\Microsoft Configuration Manager\'
      - '\IntuneManagementExtension\'
  condition: selection and not filter_legit
fields:
  - Image
  - CommandLine
  - ParentImage
  - User
falsepositives:
  - Enterprise automation tools (SCCM/Intune) using encoded scripts
  - Admin scripts (recommend script signing allowlist)
level: high
