rule Emotet_Loader_Generic
{
  meta:
    description = "Generic string-based detection for Emotet-like loaders (template)"
    author = "N SV"
    date = "2025-12-20"
    reference = "https://attack.mitre.org/software/S0367/"
    malware = "Emotet"
    confidence = "medium"
  strings:
    $mz = { 4D 5A }
    $s1 = "User-Agent:" ascii nocase
    $s2 = "POST /" ascii
    $s3 = "Mozilla/" ascii
    $s4 = "CryptUnprotectData" ascii
    $s5 = "WinHttpOpen" ascii
  condition:
    $mz at 0 and 3 of ($s*)
}
